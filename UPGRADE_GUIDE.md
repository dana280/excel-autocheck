# 🚀 מערכת בדיקת מטלות אקסל - גרסה 2.0 משודרגת

## 🎯 מה חדש?

### ✨ תכונות חדשות:
1. **בדיקת עד 50 מטלות בבת אחת** 📚
2. **גליון בדיקה בתוך כל קובץ מטלה** 📝
3. **קובץ Excel סיכום לכל המטלות** 📊
4. **תמיכה ב-Claude API לבדיקות חכמות** 🤖
5. **הורדת ארכיון ZIP עם כל הקבצים** 📦

---

## 📦 קבצים חדשים:

### קבצי קוד:
- `batch_excel_checker.py` - מנוע בדיקות מרובות (חדש!)
- `streamlit_app_v2.py` - אפליקציה משודרגת (חדש!)
- `requirements_v2.txt` - חבילות מעודכנות (חדש!)

### קבצי תיעוד:
- `UPGRADE_GUIDE.md` - מדריך שדרוג (מסמך זה)
- `API_GUIDE.md` - מדריך שימוש ב-API (יבוא)

---

## 🔄 שדרוג מגרסה 1.0

### אופציה 1: שדרוג בלי למחוק (מומלץ!)

#### שלב 1: הורידי את הקבצים החדשים
כל הקבצים החדשים נמצאים בתיקייה שהורדת.

#### שלב 2: העלי ל-GitHub
1. גשי ל-Repository שלך ב-GitHub
2. לחצי "Add file" → "Upload files"
3. העלי:
   - `batch_excel_checker.py`
   - `streamlit_app_v2.py`
   - `requirements_v2.txt`
4. Commit message: "Upgraded to v2.0"
5. "Commit changes"

#### שלב 3: עדכני את Streamlit Cloud
1. גשי ל-Streamlit Cloud Dashboard
2. לחצי על האפליקציה שלך
3. ⋮ → "Settings"
4. ב-"Main file path" שני ל: `streamlit_app_v2.py`
5. "Save"
6. האפליקציה תעודכן אוטומטית תוך 2 דקות!

---

### אופציה 2: התקנה טרייה (אם רוצה להתחיל מאפס)

#### עקבי אחרי המדריך הרגיל רק עם הקבצים החדשים:
1. מחקי את ה-Repository הישן
2. צרי Repository חדש
3. העלי את **כל** הקבצים (כולל החדשים)
4. ב-Streamlit Cloud שני את Main file ל: `streamlit_app_v2.py`

---

## 📖 איך להשתמש - מצב Batch (מספר מטלות)

### שלב 1: הכנת הקבצים

```
תיקיית_מטלות/
├── מטלה_1.xlsx
├── מטלה_2.xlsx
├── מטלה_3.xlsx
├── ...
└── מטלה_50.xlsx
```

### שלב 2: בממשק Web

1. **בחרי מצב**: "מספר מטלות (Batch)"
2. **העלי מחוון**: קובץ אחד עם קריטריוני הבדיקה
3. **העלי מטלות**: בחרי את כל 50 הקבצים (Ctrl/Cmd + Click)
4. **(אופציונלי)** הזני מזהי תלמידים בתיבת הטקסט
5. **לחצי "בצע בדיקה לכל המטלות"**
6. **המתיני** 2-5 דקות (תלוי במספר המטלות)

### שלב 3: מה תקבלי?

#### 📁 לכל מטלה:
- **קובץ המטלה המקורי + גליון בדיקה חדש** 
  - הגליון הראשון יהיה: "🎓 גליון_בדיקה"
  - כולל: ציון, פירוט, הערות, צבעים

#### 📊 קובץ סיכום Excel:
טבלה אחת עם:
- מספר מטלה
- ציון
- אחוז
- סטטוס (עבר/חלקי/נכשל)
- הערות על מה ירד

#### 📦 ארכיון ZIP:
כל הקבצים ביחד להורדה נוחה.

---

## 💡 דוגמת שימוש - Command Line

אם את רוצה להריץ מה-Command Line (לא Web):

```bash
# בדיקת מטלה בודדת
python excel_checker_advanced.py מחוון.xlsx מטלה_תלמיד.xlsx

# בדיקת כל התיקייה
python batch_excel_checker.py מחוון.xlsx תיקיית_מטלות/
```

---

## 🤖 שימוש ב-Claude API (אופציונלי)

### למה זה טוב?
Claude API יכול לעזור עם:
- זיהוי טעויות מתמטיות
- בדיקת לוגיקה עסקית
- המלצות לשיפור
- ניתוח מורכב של נוסחאות

### איך להשתמש?

#### שלב 1: קבלת API Key
1. גשי ל-https://console.anthropic.com
2. צרי חשבון (יש תקופת ניסיון חינמית!)
3. צרי API Key חדש
4. העתיקי אותו

#### שלב 2: הגדרה בממשק
1. בסרגל הצד: סמני ✅ "השתמש ב-Claude API"
2. הדביקי את ה-API Key
3. זהו! מעכשיו הבדיקות יהיו חכמות יותר

#### שלב 3: הגדרה ל-Streamlit Cloud (פרודקשן)
אם את רוצה שזה יעבוד גם באפליקציה המפורסמת:

1. Streamlit Cloud → האפליקציה שלך → Settings
2. "Secrets" → הוסיפי:
```toml
ANTHROPIC_API_KEY = "sk-ant-..."
```
3. Save
4. האפליקציה תאתחל מחדש

#### שלב 4: עדכן את הקוד
הוסיפי בתחילת `streamlit_app_v2.py`:

```python
import os
import streamlit as st

# טעינת API Key מ-secrets
if "ANTHROPIC_API_KEY" in st.secrets:
    os.environ["ANTHROPIC_API_KEY"] = st.secrets["ANTHROPIC_API_KEY"]
```

---

## 📊 מבנה גליון הבדיקה

הגליון שיווצר בכל מטלה יכלול:

```
┌─────────────────────────────────────────────────┐
│     דוח בדיקת מטלה אוטומטית                    │ (כחול כהה)
├─────────────────────────────────────────────────┤
│ מספר מטלה: 12345                                │
│ תאריך בדיקה: 02/11/2025 15:30                  │
├─────────────────────────────────────────────────┤
│           סיכום ציונים                          │ (כחול בהיר)
│ ציון כולל: 85.5 / 100                           │
│ אחוז: 85.5%                                     │
├───┬─────────┬──────────┬─────────┬────────┬────┤
│ # │ סעיף    │ תת-סעיף  │ סטטוס   │ ציון   │ הערות│
├───┼─────────┼──────────┼─────────┼────────┼────┤
│ 1 │ חישובים │ סה"כ     │ ✅ עבר   │ 10/10  │ ... │ (רקע ירוק)
│ 2 │ נוסחאות│ SUM      │ ⚠️ חלקי  │ 7/10   │ ... │ (רקע כתום)
│ 3 │ תנאים  │ IF       │ ❌ נכשל  │ 0/5    │ ... │ (רקע אדום)
└───┴─────────┴──────────┴─────────┴────────┴────┘
```

---

## 📈 מבנה קובץ הסיכום

קובץ Excel הסיכום יכלול:

| מספר_מטלה | ציון | מקסימום | אחוז | סטטוס | בדיקות_שעברו | בדיקות_שנכשלו | הערות_מה_ירד |
|-----------|------|---------|------|-------|--------------|---------------|-------------|
| מטלה_1    | 85.5 | 100     | 85.5%| עבר   | 8            | 2             | נוסחאות: -2.5 נקודות |
| מטלה_2    | 92.0 | 100     | 92.0%| עבר   | 10           | 0             | הכל תקין |
| ...       | ...  | ...     | ...  | ...   | ...          | ...           | ... |

עם צביעה:
- 🟢 שורות ירוקות: עברו (80%+)
- 🟡 שורות לבנות: עברו חלקית (60-79%)
- 🔴 שורות אדומות: נכשלו (<60%)

---

## 🎯 תרחישים לדוגמה

### תרחיש 1: מורה עם 30 תלמידים

```
1. הכנת מחוון אחד
2. קבלת 30 מטלות מהתלמידים
3. העלאה למערכת (5 דקות)
4. המתנה לבדיקה (3 דקות)
5. הורדת:
   - 30 קבצים עם גליון בדיקה
   - קובץ סיכום אחד
6. שליחת הקבצים חזרה לתלמידים
```

**זמן חיסכון**: במקום 5 שעות → 15 דקות!

### תרחיש 2: מנהל מחלקה

```
1. קבלת קובץ הסיכום
2. ניתוח:
   - כמה עברו?
   - מה הבעיות הנפוצות?
   - מי צריך עזרה?
3. קבלת החלטות מבוססות נתונים
```

---

## ⚠️ הגבלות

### גבולות טכניים:
- **מקסימום מטלות**: 50 בבת אחת
- **גודל קובץ**: עד 200MB לכל קובץ
- **זמן עיבוד**: ~3-5 שניות למטלה
- **שימוש ב-API**: תלוי בחבילת ה-API שלך

### המלצות:
- לפחות מ-50 מטלות → חלקי לאצווות
- קבצים גדולים → דחוס לפני העלאה
- בדיקות מורכבות → השתמשי ב-API

---

## 🐛 פתרון בעיות

### "Out of memory"
**פתרון**: חלקי את המטלות לקבוצות קטנות יותר (25 בכל פעם)

### "API rate limit exceeded"
**פתרון**: השתמשי במצב רגיל (ללא AI) או המתיני דקה

### "File too large"
**פתרון**: עדכני את `config.toml`:
```toml
[server]
maxUploadSize = 500
```

---

## 📞 תמיכה

- 📖 מדריכים: `README.md`, `DEPLOYMENT_GUIDE.md`
- 🐛 בעיות: `TROUBLESHOOTING.md`
- 🔧 שדרוג: `UPGRADE_GUIDE.md` (מסמך זה)
- 💬 שאלות: פתחי issue ב-GitHub

---

## 🎉 סיכום

עכשיו יש לך מערכת מתקדמת שיכולה:

✅ לבדוק 50 מטלות בבת אחת
✅ להוסיף גליון בדיקה לכל מטלה
✅ ליצור קובץ סיכום Excel
✅ להשתמש ב-AI לבדיקות חכמות
✅ לחסוך שעות עבודה!

**בהצלחה עם הגרסה החדשה! 🚀**

---

**גרסה**: 2.0
**תאריך**: נובמבר 2025
**רישיון**: MIT
